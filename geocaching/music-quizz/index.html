<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Band Quiz</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/fuzzysort@2.0.4/fuzzysort.min.js"></script>
</head>
<body>

<h1>Band Quiz</h1>

<div id="statistics" style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; text-align: center;">
  <div>
    <div style="font-size: 1.5rem; font-weight: bold; color: #28a745;" id="solved-percentage">0%</div>
    <div style="color: #6c757d; font-size: 0.9rem;">Solved Total</div>
  </div>
  <div>
    <div style="font-size: 1.5rem; font-weight: bold; color: #28a745;" id="solved-percentage-batch">0%</div>
    <div style="color: #6c757d; font-size: 0.9rem;">Solved Batch</div>
  </div>
  <div>
    <div style="font-size: 1.5rem; font-weight: bold; color: #007bff;" id="listened-percentage">0%</div>
    <div style="color: #6c757d; font-size: 0.9rem;">Listened</div>
  </div>
</div>

<div id="sum-of-codes-container" style="background: #fff3cd; border: 1px solid #ffc107; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; display: none;">
  <h3 style="margin: 0 0 0.5rem 0; color: #856404;">ðŸŽ‰ Congratulations! All 20 Puzzles Solved!</h3>
  <div style="font-weight: bold; margin-bottom: 0.5rem;">Sum of Codes: <span id="sum-of-codes-total">0</span></div>
  <div id="sum-of-codes-details" style="font-family: monospace; font-size: 0.9rem; line-height: 1.6; color: #495057; margin-bottom: 1rem;"></div>
  <a id="final-solution-link" href="#" target="_blank" style="display: none; padding: 0.5rem 1rem; background: #28a745; color: white; text-decoration: none; border-radius: 4px; font-weight: bold;">ðŸŽ¯ Go to Final Solution</a>
</div>

<div class="controls">
  <label for="source-select">Source File:</label>
  <select id="source-select">
    <option value="">Select a source file...</option>
  </select>
  <span id="count-display"></span>
  <button id="download-csv" type="button" style="margin-left: 1rem; padding: 0.5rem 1rem; background: #0066cc; color: white; border: none; border-radius: 4px; cursor: pointer;">Download State CSV</button>
  <button id="show-unsolved-btn" type="button" style="margin-left: 0.5rem; padding: 0.5rem 1rem; background: #ffc107; color: #333; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">Show Unsolved Bands</button>
</div>



<div id="large-image-display">
  <img id="large-image" src="" alt="Large view">
  <div class="large-info">
    <div><strong>Source:</strong> <span id="large-source"></span></div>
    <div><a id="large-certitude" href="" target="_blank" class="certitude-link">Certitude Link</a></div>
  </div>
  <div class="large-controls">
    <div class="large-status-controls">
      <div class="large-status-row">
        <label><strong>Status:</strong></label>
        <select id="large-status-select" class="large-status-select">
          <option value="unsolved">Unsolved</option>
          <option value="solved">Solved</option>
        </select>
        <label><strong>Artist:</strong></label>
        <div class="band-search-container">
          <input type="text" id="large-band-search" class="band-search-input" placeholder="Search for band...">
          <div id="large-band-dropdown" class="band-dropdown"></div>
        </div>
        <label style="display: flex; align-items: center; gap: 0.5rem; margin-left: 1rem;">
          <input type="checkbox" id="large-listened-checkbox" style="margin: 0;">
          <strong>Listened</strong>
        </label>
      </div>
      <textarea id="large-note-input" 
                class="large-note-input" 
                placeholder="Notes (max 300 chars)..." 
                maxlength="300"></textarea>
      <input type="text" id="large-code-input" class="band-search-input" placeholder="Add code...">
    </div>
  </div>
</div>
<div id="image-container"></div>

<p id="status">Loading dataâ€¦</p>

<!-- Modal for Unsolved Bands -->
<div id="unsolved-modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5);">
  <div style="background-color: #fefefe; margin: 5% auto; padding: 2rem; border: 1px solid #888; border-radius: 8px; width: 80%; max-width: 600px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
      <h2 style="margin: 0; color: #333;">Unsolved Bands</h2>
      <button id="close-modal" style="background: #dc3545; color: white; border: none; border-radius: 4px; padding: 0.5rem 1rem; cursor: pointer; font-size: 1rem;">&times; Close</button>
    </div>
    <p style="color: #666; margin-bottom: 1rem;">Bands from the current batch that haven't been solved yet:</p>
    <textarea id="unsolved-bands-textarea" readonly style="width: 100%; min-height: 300px; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; font-size: 0.9rem; resize: vertical;"></textarea>
  </div>
</div>

<script src="script.js"></script>

</body>
</html>